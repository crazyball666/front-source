(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{144:function(t,e,a){"use strict";a.r(e);var n=a(428),r=a(350);for(var i in r)"default"!==i&&function(t){a.d(e,t,function(){return r[t]})}(i);a(410);var u=a(91),s=Object(u.a)(r.default,n.a,n.b,!1,null,"2d2ff64d",null);s.options.__file="src/page/service-go/config/module-detail.vue",e.default=s.exports},296:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=u(a(89)),r=u(a(90)),i=u(a(140));function u(t){return t&&t.__esModule?t:{default:t}}var s="https://service-go.crazyball.xyz";e.default={getCBAppLogsList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.default)(n.default.mark(function r(){var o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.get(s+"/cbapp/logs?page="+t+"&limit="+a+"&search="+u);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},r,e)}))()},getCBAppUserList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.default)(n.default.mark(function r(){var o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.get(s+"/cbapp/users?page="+t+"&limit="+a+"&search="+u);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},r,e)}))()},getCBAppAllMenuList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.default)(n.default.mark(function r(){var o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.get(s+"/cbapp/menu/list?page="+t+"&limit="+a+"&search="+u);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},r,e)}))()},getConfigModuleList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.default)(n.default.mark(function r(){var o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.get(s+"/config/module/list?page="+t+"&limit="+a+"&search="+u);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},r,e)}))()},createConfigModule:function(t,e){var a=this;return(0,r.default)(n.default.mark(function r(){var u;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.default.post(s+"/config/module/create",{name:t,description:e});case 2:return u=a.sent,a.abrupt("return",u);case 4:case"end":return a.stop()}},r,a)}))()},deleteConfigModule:function(t){var e=this;return(0,r.default)(n.default.mark(function a(){var r;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.delete(s+"/config/module/"+t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},a,e)}))()},updateConfigModule:function(t,e,a){var u=this;return(0,r.default)(n.default.mark(function r(){var o;return n.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.default.put(s+"/config/module/"+t,{name:e,description:a});case 2:return o=n.sent,n.abrupt("return",o);case 4:case"end":return n.stop()}},r,u)}))()},getConfigModuleItemList:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return(0,r.default)(n.default.mark(function r(){var c;return n.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.default.get(s+"/config/item/list?page="+a+"&limit="+o+"&search="+l+"&module_id="+t+"&parent_id="+e);case 2:return c=n.sent,n.abrupt("return",c);case 4:case"end":return n.stop()}},r,u)}))()},addConfigItem:function(t){var e=this;return(0,r.default)(n.default.mark(function a(){var r;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t.value_type=parseInt(t.value_type)}catch(t){}return e.next=3,i.default.post(s+"/config/item/create",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},a,e)}))()},updateConfigItem:function(t,e){var a=this;return(0,r.default)(n.default.mark(function r(){var u;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:try{e.value_type=parseInt(e.value_type)}catch(t){}return a.next=3,i.default.put(s+"/config/item/"+t,{name:e.name,description:e.description,key:e.key,value:e.value,value_type:e.value_type});case 3:return u=a.sent,a.abrupt("return",u);case 5:case"end":return a.stop()}},r,a)}))()},deleteConfigItem:function(t){var e=this;return(0,r.default)(n.default.mark(function a(){var r;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.delete(s+"/config/item/"+t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},a,e)}))()},configTest:function(t,e){var a=this;return(0,r.default)(n.default.mark(function r(){var u;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.default.get(s+"/config/get?module="+t+"&keys="+e);case 2:return u=a.sent,a.abrupt("return",u);case 4:case"end":return a.stop()}},r,a)}))()}}},350:function(t,e,a){"use strict";a.r(e);var n=a(351),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e.default=r.a},351:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=u(a(89)),r=u(a(90)),i=u(a(296));function u(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{valueTypeMap:{0:"Null",1:"Number",2:"String",3:"Bool",4:"Array",5:"Object"},itemCount:0,currentPage:1,pageSize:10,loading:!1,itemList:[],search:"",showAddItemDialog:!1,formData:{module_id:0,parent_id:null,name:"",description:"",key:"",value:"",value_type:"0"},loadingAddItemDialog:!1,selectedRowId:null,routeListener:null}},mounted:function(){var t=(0,r.default)(n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.resetFormData(),this.updateList();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),activated:function(){this.routeListener=this.$watch("$route",this.updateRoute)},deactivated:function(){this.routeListener&&this.routeListener()},methods:{updateRoute:function(t,e){this.itemCount=0,this.currentPage=1,this.loading=!1,this.itemList=[],this.search="",this.showAddItemDialog=!1,this.resetFormData(),this.selectedRowId=!1,this.loadingAddItemDialog=!1,this.updateList()},resetFormData:function(){this.formData.module_id=parseInt(this.$route.params.id),this.formData.parent_id=parseInt(this.$route.query.parent_id),this.formData.name="",this.formData.description="",this.formData.key="",this.formData.value="",this.formData.value_type="0"},updateList:function(){var t=(0,r.default)(n.default.mark(function t(){var e;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,i.default.getConfigModuleItemList(this.$route.params.id,this.$route.query.parent_id,this.currentPage-1,this.pageSize,this.search);case 4:e=t.sent,this.itemList=e.data.items,this.itemCount=e.data.count,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:this.loading=!1;case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(){return t.apply(this,arguments)}}(),pageDidChange:function(){var t=(0,r.default)(n.default.mark(function t(e){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentPage=e,t.next=3,this.updateList();case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getValueType:function(t){return this.valueTypeMap[t]},searchItem:function(){},onCloseAddItemDialog:function(){this.resetFormData(),this.selectedRowId=!1,this.showAddItemDialog=!1},onSubmitItem:function(){var t=this;return(0,r.default)(n.default.mark(function e(){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.formData.module_id&&t.formData.name&&t.formData.description&&t.formData.key&&t.formData.value){e.next=3;break}return t.$message.error("不能为空"),e.abrupt("return");case 3:if(t.loadingAddItemDialog=!0,e.prev=4,!t.selectedRowId){e.next=11;break}return e.next=8,i.default.updateConfigItem(t.selectedRowId,t.formData);case 8:t.$message.success("更新成功"),e.next=14;break;case 11:return e.next=13,i.default.addConfigItem(t.formData);case 13:t.$message.success("添加成功");case 14:t.showAddItemDialog=!1,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.log(e.t0);case 20:t.loadingAddItemDialog=!1,t.updateList();case 22:case"end":return e.stop()}},e,t,[[4,17]])}))()},onClickEditItem:function(t){var e=this;return(0,r.default)(n.default.mark(function a(){return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.showAddItemDialog=!0,e.selectedRowId=t.id,e.formData.name=t.name,e.formData.description=t.description,e.formData.key=t.key,e.formData.value=t.value,e.formData.value_type=t.value_type.toString();case 7:case"end":return a.stop()}},a,e)}))()},onClickDeleteItem:function(t){var e=this;return(0,r.default)(n.default.mark(function a(){return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.$confirm("删除此配置？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 3:return a.next=5,i.default.deleteConfigItem(t.id);case 5:e.$message.success("删除成功"),e.updateList(),a.next=11;break;case 9:a.prev=9,a.t0=a.catch(0);case 11:case"end":return a.stop()}},a,e,[[0,9]])}))()},onClickDetail:function(){var t=(0,r.default)(n.default.mark(function t(e){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push({path:this.$route.path+"/"+e.key,query:{parent_id:e.id}});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}}},352:function(t,e,a){},410:function(t,e,a){"use strict";var n=a(352);a.n(n).a},428:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"module-detail-page"},[a("div",{staticClass:"search-bar"},[parseInt(t.$route.query.parent_id)>0?a("el-button",{staticClass:"back-btn",attrs:{type:"danger"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("后退")]):t._e(),t._v(" "),a("el-input",{staticClass:"input-box",attrs:{placeholder:"搜索配置项"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchItem}},[t._v("搜索")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showAddItemDialog=!0}}},[t._v("添加")])],1),t._v(" "),parseInt(t.$route.query.parent_id)>0?a("p",{staticStyle:{color:"#909399",padding:"10px 0"}},[t._v("\n    父配置："+t._s(t.$route.path.replace(/\/service-go\/config\/module\/\d*\//,""))+"\n  ")]):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table",attrs:{data:t.itemList,"empty-text":"暂无数据",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"id",align:"center","class-name":"column-content"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",align:"center","class-name":"column-content"}}),t._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述",align:"center","class-name":"column-content"}}),t._v(" "),a("el-table-column",{attrs:{prop:"key",label:"key",align:"center","class-name":"column-content"}}),t._v(" "),a("el-table-column",{attrs:{prop:"value",label:"配置值",align:"center","class-name":"column-content"}}),t._v(" "),a("el-table-column",{attrs:{label:"类型",align:"center","class-name":"column-content"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.getValueType(e.row.value_type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.onClickDetail(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.onClickEditItem(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.onClickDeleteItem(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.itemCount,"current-page":t.currentPage,"page-size":t.pageSize},on:{"current-change":t.pageDidChange}}),t._v(" "),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAddItemDialog,expression:"loadingAddItemDialog"}],attrs:{title:"创建配置项",visible:t.showAddItemDialog},on:{"update:visible":function(e){t.showAddItemDialog=e},closed:t.onCloseAddItemDialog}},[a("el-row",{staticClass:"input-row",attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t._v("名称")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1),t._v(" "),a("el-row",{staticClass:"input-row",attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t._v("描述")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1)],1),t._v(" "),a("el-row",{staticClass:"input-row",attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t._v("key")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:t.formData.key,callback:function(e){t.$set(t.formData,"key",e)},expression:"formData.key"}})],1)],1),t._v(" "),a("el-row",{staticClass:"input-row",attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t._v("value")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:t.formData.value,callback:function(e){t.$set(t.formData,"value",e)},expression:"formData.value"}})],1)],1),t._v(" "),a("el-row",{staticClass:"input-row",attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t._v("数据类型")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.formData.value_type,callback:function(e){t.$set(t.formData,"value_type",e)},expression:"formData.value_type"}},t._l(t.valueTypeMap,function(t,e){return a("el-option",{key:e,attrs:{label:e+" - "+t,value:e}})}),1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showAddItemDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitItem}},[t._v("确 定")])],1)],1)],1)},r=[];n._withStripped=!0,a.d(e,"a",function(){return n}),a.d(e,"b",function(){return r})}}]);