(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{282:function(e,t,n){"use strict";n.r(t);var a=n(418),o=n(321);for(var l in o)"default"!==l&&function(e){n.d(t,e,function(){return o[e]})}(l);n(400);var r=n(91),i=Object(r.a)(o.default,a.a,a.b,!1,null,"4b16fa8d",null);i.options.__file="src/page/user-module/role-list.vue",t.default=i.exports},321:function(e,t,n){"use strict";n.r(t);var a=n(322),o=n.n(a);for(var l in a)"default"!==l&&function(e){n.d(t,e,function(){return a[e]})}(l);t.default=o.a},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(89)),o=r(n(90)),l=r(n(141));function r(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{loading:!1,loadingPower:!1,loadingCreate:!1,currentPage:1,pageSize:10,roleList:[],roleCount:0,showDialog:!1,showAssociateDialog:!1,powerList:[],tempRole:null,roleForm:{role:""}}},mounted:function(){var e=this;return(0,o.default)(a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateRoleList();case 2:case"end":return t.stop()}},t,e)}))()},methods:{updateRoleList:function(){var e=(0,o.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,l.default.getRoleList(this.currentPage-1,this.pageSize);case 3:t=e.sent,this.roleCount=t.data.count,this.roleList=t.data.roles,this.loading=!1;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pageDidChange:function(){var e=(0,o.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPage=t,e.next=3,this.updateRoleList();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleAddRole:function(){var e=(0,o.default)(a.default.mark(function e(){var t=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadingCreate=!0,l.default.createRole(this.roleForm).then(function(e){t.handleCloseDialog(),t.$message({type:"success",message:"新建成功"}),t.loadingCreate=!1}).then(function(){return t.updateRoleList()}).catch(function(e){t.loadingCreate=!1});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleCloseDialog:function(){this.roleForm.role="",this.showDialog=!1},handleDelete:function(e){var t=this;this.$confirm("是否删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return l.default.deleteRole(e)}).then(function(e){return t.$message({type:"success",message:"删除成功!"}),t.loading=!0,t.updateRoleList()}).then(function(){t.loading=!1}).catch(function(){})},handleAssociate:function(){var e=(0,o.default)(a.default.mark(function e(t){var n=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.showAssociateDialog=!0,this.loadingPower=!0,this.tempRole=t,l.default.getAllPower().then(function(e){n.loadingPower=!1;var a=t.powers&&t.powers.split(",")||[];e.data.forEach(function(e){e.select=a.includes(e.power)}),n.powerList=e.data}).catch(function(e){n.loadingPower=!1});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCloseAssociateDialog:function(){this.showAssociateDialog=!1,this.updateRoleList()},handleSwitchChange:function(){var e=(0,o.default)(a.default.mark(function e(t){var n=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadingPower=!0,t.select?l.default.addRolePowerRelation(this.tempRole.id,t.id).then(function(e){n.loadingPower=!1}).catch(function(e){n.loadingPower=!1,t.select=!1}):l.default.deleteRolePowerRelation(this.tempRole.id,t.id).then(function(e){n.loadingPower=!1}).catch(function(e){n.loadingPower=!1,t.select=!0});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}}},323:function(e,t,n){},400:function(e,t,n){"use strict";var a=n(323);n.n(a).a},418:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"role-list"},[n("h1",{staticClass:"title"},[e._v("角色管理")]),e._v(" "),n("el-row",{staticClass:"add-btn-row",attrs:{type:"flex",justify:"end"}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showDialog=!0}}},[e._v("新增角色")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.roleList,"empty-text":"暂无数据",border:""}},[n("el-table-column",{attrs:{prop:"id",label:"ID",align:"center","class-name":"column-content",width:"150"}}),e._v(" "),n("el-table-column",{attrs:{prop:"role",label:"角色",align:"center","class-name":"column-content"}}),e._v(" "),n("el-table-column",{attrs:{prop:"powers",label:"拥有权限",align:"center","class-name":"column-content"}}),e._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"创建时间",align:"center","class-name":"column-content"}}),e._v(" "),n("el-table-column",{attrs:{prop:"",label:"操作",align:"center","class-name":"column-content",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"associateBtn",attrs:{type:"text",size:"small"},on:{click:function(n){return e.handleAssociate(t.row)}}},[e._v("关联权限")]),e._v(" "),n("el-button",{staticClass:"deleteBtn",attrs:{type:"text",size:"small"},on:{click:function(n){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:e.roleCount,"current-page":e.currentPage,"page-size":e.pageSize},on:{"current-change":e.pageDidChange}}),e._v(" "),n("el-dialog",{attrs:{title:"新增角色",visible:e.showDialog,width:"350px",center:!0},on:{close:e.handleCloseDialog}},[n("el-form",{attrs:{model:e.roleForm,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"角色名称："}},[n("el-input",{model:{value:e.roleForm.role,callback:function(t){e.$set(e.roleForm,"role",t)},expression:"roleForm.role"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:e.loadingCreate},on:{click:e.handleAddRole}},[e._v("确 定")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"关联权限",visible:e.showAssociateDialog,width:"600px",center:!0},on:{close:e.handleCloseAssociateDialog}},[n("div",{staticClass:"tips"},[e._v("编辑角色："+e._s(e.tempRole?e.tempRole.role:"UNKNOW"))]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPower,expression:"loadingPower"}],staticClass:"power-list"},[n("div",{staticClass:"line"}),e._v(" "),e._l(e.powerList,function(t){return n("div",{key:t.id,staticClass:"power-box"},[n("span",{staticClass:"power-title"},[e._v(e._s(t.power))]),e._v(" "),n("el-switch",{attrs:{"active-color":"#67C23A","inactive-color":"#F56C6C"},on:{change:function(n){return e.handleSwitchChange(t)}},model:{value:t.select,callback:function(n){e.$set(t,"select",n)},expression:"power.select"}})],1)})],2)])],1)},o=[];a._withStripped=!0,n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})}}]);